# Plan AI - Система оптимизации раскладки плит

## Описание проекта

Система для автоматизации планирования производства железобетонных плит с оптимизацией раскладки и созданием конструкторских заданий (КЗ).

## Основные возможности

- **Оптимизация раскладки плит** - автоматический расчет оптимального размещения плит на дорожках
- **Создание КЗ файлов** - генерация конструкторских заданий в формате Excel
- **Визуализация планов** - создание схем и диаграмм раскладки
- **База данных производства** - хранение и управление данными о производстве
- **Планирование по дням** - создание планов производства на каждый день
- **Генерация коммерческих предложений в PDF** - автоматическое создание КП с расчётом стоимости, веса и НДС
- **Telegram бот** - удобный интерфейс для работы через мессенджер

## Структура проекта

```
├── bot_main.py                    # Telegram бот - главный файл
├── bot_handlers.py                # Обработчики команд бота
├── bot_config.py                  # Конфигурация бота
├── commercial_offer.py            # Генерация коммерческих предложений PDF
├── config_and_data.py             # Конфигурация и парсинг данных
├── optimization.py                # Алгоритмы оптимизации раскроя
├── planning.py                    # Планирование производства по дням
├── visualization.py               # Визуализация раскладки
├── price_db.py                    # Работа с базой цен
├── pb.db                          # SQLite база данных цен
├── requirements.txt               # Зависимости проекта
├── README_BOT.md                  # Документация по боту
├── README_COMMERCIAL_OFFER.md     # Документация по генерации КП
└── Визуализация_Раскладки/        # Результаты работы системы
```

## Установка и запуск

1. Установите Python 3.10+
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Настройте бота (создайте файл `bot.env`):
   ```env
   BOT_TOKEN=your_telegram_bot_token_here
   ```
4. Запустите Telegram бота:
   ```bash
   python bot_main.py
   ```

### Альтернативный запуск (прямой вызов)

Для генерации КП без бота:
```bash
python commercial_offer.py
```

## Основные модули

- `bot_main.py` - Telegram бот (главный интерфейс)
- `commercial_offer.py` - генерация коммерческих предложений в PDF
- `optimization.py` - алгоритмы оптимизации раскроя (каскадные резы)
- `planning.py` - планирование производства по дням
- `visualization.py` - визуализация раскладки плит
- `price_db.py` - управление базой данных цен

### Дополнительные утилиты

- `visualize_kz_plan.py` - визуализация КЗ планов
- `check_lengths.py` - проверка длин плит
- `check_loads.py` - проверка нагрузок
- `analyze_plates.py` - анализ плит

## Результаты работы

Система создает:
- **Коммерческие предложения в PDF** - с расчётом стоимости, веса, НДС
- **Оптимизированные планы раскладки** - визуализация в PNG/PDF
- **Ведомости материалов** - детальные спецификации в XLSX/CSV
- **Сметы стоимости** - расчёт материалов и резов
- **Календарные планы** - планирование производства по дням
- **Статистику и отчёты** - анализ эффективности и отходов

## Работа через Telegram бота

### Основные команды

- `/start` - Главное меню
- `/commercial_offer` - Создать коммерческое предложение
- `/build_plan` - Построить план раскладки
- `/optimize` - Оптимизировать раскрой
- `/help` - Справка
- `/stats` - Статистика

### Основные кнопки

- **"Получить КП"** - расчёт с визуализацией
- **"Коммерческое предложение PDF"** - генерация КП в PDF
- **"Планирование по дням"** - календарный план
- **"Оптимизация резов"** - каскадная оптимизация

### Пример работы

1. Нажмите "Коммерческое предложение PDF"
2. Отправьте список плит:
   ```
   1.2×3.39 — 2 шт
   0.32×6.63 — 4 шт
   ПБ 78-3-8п 3
   ```
3. Получите готовый PDF с расчётами

## Документация

- `README.md` - Основная документация (этот файл)
- `README_BOT.md` - Документация по Telegram боту
- `README_COMMERCIAL_OFFER.md` - Генерация коммерческих предложений
- `QUICK_START.md` - Быстрый старт
- `CHANGELOG.md` - История изменений
- `opisanie/` - Детальные описания функциональности

## Автор

khimich1

## Лицензия

Проект для внутреннего использования
